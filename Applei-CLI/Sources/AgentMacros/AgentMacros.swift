import SwiftCompilerPlugin\nimport SwiftSyntax\nimport SwiftSyntaxMacros\n\npublic struct AgentToolMacro: PeerMacro {\n    public static func expansion(\n        of node: AttributeSyntax,\n        providingPeersOf declaration: some DeclSyntaxProtocol,\n        in context: some MacroExpansionContext\n    ) throws -> [DeclSyntax] {\n        return []\n    }\n}\n\npublic struct AgentSkillMacro: MemberMacro {\n    public static func expansion(\n        of node: AttributeSyntax,\n        providingMembersOf declaration: some DeclGroupSyntax,\n        in context: some MacroExpansionContext\n    ) throws -> [DeclSyntax] {\n        guard case .argumentList(let arguments) = node.arguments else {\n            return []\n        }\n\n        var nameExpr: ExprSyntax?\n        var descExpr: ExprSyntax?\n        var markdownExpr: ExprSyntax?\n\n        for arg in arguments {\n            if arg.label?.text == \"name\" {\n                nameExpr = arg.expression\n            } else if arg.label?.text == \"description\" {\n                descExpr = arg.expression\n            } else if arg.label?.text == \"markdown\" {\n                markdownExpr = arg.expression\n            }\n        }\n\n        guard let name = nameExpr, let desc = descExpr, let markdown = markdownExpr else {\n            return []\n        }\n\n        return [\n            \"\"\"\n            static let _skill_metadata: [String: String] = [\n                \"name\": \\(name),\n                \"description\": \\(desc),\n                \"markdown\": \\(markdown)\n            ]\n            \"\"\"\n        ]\n    }\n}\n\npublic struct AgentProviderMacro: MemberMacro {\n    public static func expansion(\n        of node: AttributeSyntax,\n        providingMembersOf declaration: some DeclGroupSyntax,\n        in context: some MacroExpansionContext\n    ) throws -> [DeclSyntax] {\n        guard case .argumentList(let arguments) = node.arguments else {\n            return []\n        }\n\n        var typeExpr: ExprSyntax?\n        var urlExpr: ExprSyntax?\n\n        for arg in arguments {\n            if arg.label?.text == \"type\" {\n                typeExpr = arg.expression\n            } else if arg.label?.text == \"defaultUrl\" {\n                urlExpr = arg.expression\n            }\n        }\n\n        guard let type = typeExpr, let url = urlExpr else {\n            return []\n        }\n\n        return [\n            \"\"\"\n            static let _provider_metadata: [String: String] = [\n                \"type\": \"\\(type)\",\n                \"defaultUrl\": \\(url)\n            ]\n            \"\"\"\n        ]\n    }\n}\n\n@main\nstruct AgentMacrosPlugin: CompilerPlugin {\n    let providingMacros: [Macro.Type] = [\n        AgentToolMacro.self,\n        AgentSkillMacro.self,\n        AgentProviderMacro.self\n    ]\n}\n